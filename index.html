<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Scorekeeper Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <meta name="theme-color" content="#050816" />

  <style>
    :root {
      --bg: #050816;
      --bg-soft: #0c1224;

      --card: #111827;
      --card-soft: #1f2937;

      --accent: #f97316;
      --accent2: #fb923c;
      --accent3: #38bdf8;

      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: rgba(148,163,184,0.18);

      --radius: 18px;
      --shadow: 0 16px 40px rgba(0,0,0,0.35);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text-main);
      background:
        radial-gradient(1200px 700px at 20% 0%, rgba(249,115,22,0.22), transparent 60%),
        radial-gradient(1000px 650px at 85% 15%, rgba(56,189,248,0.14), transparent 55%),
        radial-gradient(900px 600px at 40% 110%, rgba(34,197,94,0.10), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg-soft));
      overflow-x: hidden;
    }

    /* subtle moving sparkle/noise-ish overlay */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events:none;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.10), transparent 60%),
        radial-gradient(2px 2px at 70% 40%, rgba(255,255,255,0.08), transparent 60%),
        radial-gradient(2px 2px at 40% 80%, rgba(255,255,255,0.07), transparent 60%),
        radial-gradient(2px 2px at 85% 75%, rgba(255,255,255,0.06), transparent 60%);
      opacity: 0.35;
      filter: blur(0.2px);
      animation: drift 12s ease-in-out infinite alternate;
    }
    @keyframes drift{
      from { transform: translate3d(0,0,0); }
      to   { transform: translate3d(-10px, 8px, 0); }
    }

    .safe {
      padding-top: max(14px, env(safe-area-inset-top));
      padding-bottom: max(14px, env(safe-area-inset-bottom));
      padding-left: max(14px, env(safe-area-inset-left));
      padding-right: max(14px, env(safe-area-inset-right));
      min-height: 100%;
    }

    .wrap {
      max-width: 820px;
      margin: 0 auto;
      padding: 18px 14px 18px;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 14px;
      border: 1px solid var(--border-subtle);
      background: rgba(17, 24, 39, 0.72);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      position: sticky;
      top: max(10px, env(safe-area-inset-top));
      z-index: 10;
    }

    .brand{
      display:flex;
      flex-direction:column;
      gap: 4px;
      min-width: 0;
    }

    .brand h1 {
      margin: 0;
      font-size: 19px;
      letter-spacing: 0.2px;
      display:flex;
      align-items:center;
      gap: 10px;
      text-shadow: 0 1px 10px rgba(0,0,0,0.35);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .brand h1 .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--accent2), var(--accent));
      box-shadow: 0 0 18px rgba(249,115,22,0.45);
      flex: 0 0 auto;
    }

    .brand p {
      margin: 0;
      font-size: 13px;
      color: var(--text-muted);
    }

    .btn {
      border: 1px solid rgba(249,115,22,0.55);
      background: linear-gradient(180deg, rgba(249,115,22,0.30), rgba(17,24,39,0.92));
      color: var(--text-main);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(0,0,0,0.25);
      transition: transform 140ms ease, box-shadow 140ms ease, border-color 140ms ease;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(249,115,22,0.8);
      box-shadow: 0 14px 26px rgba(0,0,0,0.30), 0 0 0 3px rgba(249,115,22,0.15);
    }
    .btn:active{ transform: translateY(0px); }

    .content { margin-top: 16px; }

    .panel {
      border: 1px solid var(--border-subtle);
      background: rgba(17, 24, 39, 0.72);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .panel h2 {
      margin: 0 0 12px;
      font-size: 14px;
      letter-spacing: 0.2px;
      color: rgba(255,255,255,0.92);
    }

    /* VERTICAL LIST */
    .list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* ====== IMPROVED SCORER BUTTON ====== */
    .card {
      width: 100%;
      border: none;
      border-radius: 22px;
      padding: 14px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 14px;
      text-align: left;
      user-select: none;
      touch-action: manipulation;
      background: rgba(17,24,39,0.88);
      box-shadow: 0 18px 34px rgba(0,0,0,0.32);
      transition: transform 140ms ease, box-shadow 140ms ease;
    }

    /* gradient “neon” border */
    .card::before{
      content:"";
      position:absolute;
      inset: 0;
      padding: 1px;
      border-radius: 22px;
      background: linear-gradient(120deg,
        rgba(249,115,22,0.85),
        rgba(56,189,248,0.55),
        rgba(249,115,22,0.75)
      );
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events:none;
      opacity: 0.55;
    }

    /* left accent stripe */
    .card::after{
      content:"";
      position:absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 6px;
      background: linear-gradient(180deg, rgba(249,115,22,0.95), rgba(251,146,60,0.75));
      opacity: 0.75;
      pointer-events:none;
    }

    .card:hover{
      transform: translateY(-1px);
      box-shadow: 0 22px 42px rgba(0,0,0,0.38), 0 0 0 4px rgba(249,115,22,0.14);
    }
    .card:active{ transform: translateY(0px); }

    .card:focus-visible {
      outline: none;
      box-shadow: 0 0 0 4px rgba(249,115,22,0.28), 0 22px 42px rgba(0,0,0,0.38);
    }

    /* Image slot: circular mask + vignette to hide white edges */
    .thumb {
      width: 70px;
      height: 70px;
      border-radius: 20px;
      flex: 0 0 70px;
      position: relative;
      overflow: hidden;
      background:
        radial-gradient(120px 90px at 30% 30%, rgba(249,115,22,0.28), transparent 70%),
        linear-gradient(180deg, rgba(31,41,55,0.95), rgba(17,24,39,0.95));
      box-shadow: 0 10px 18px rgba(0,0,0,0.28);
      border: 1px solid rgba(249,115,22,0.35);
      display: grid;
      place-items: center;
    }

    /* circular crop inside the rounded square */
    .thumb img {
      width: 92%;
      height: 92%;
      object-fit: cover;
      border-radius: 50%;
      display: block;
      /* this helps soften harsh white edges a bit */
      box-shadow: 0 0 0 10px rgba(17,24,39,0.25) inset;
      filter: saturate(1.05) contrast(1.05);
      background: transparent;
    }

    /* vignette overlay to visually blend image edges */
    .thumb::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 50% 50%, transparent 55%, rgba(5,8,22,0.35) 100%);
      pointer-events:none;
    }

    .thumb .placeholder {
      font-weight: 900;
      color: rgba(249,115,22,0.92);
      letter-spacing: 0.6px;
      font-size: 18px;
      text-shadow: 0 2px 12px rgba(0,0,0,0.35);
    }

    .meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
      flex: 1 1 auto;
      padding-left: 2px;
    }

    /* READABILITY BOOST */
    .name {
      margin: 0;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: 0.2px;
      line-height: 1.15;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: rgba(255,255,255,0.95);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.35),
        0 8px 18px rgba(0,0,0,0.35);
    }

    .subline {
      margin: 0;
      font-size: 12.5px;
      color: rgba(156,163,175,0.95);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .chev {
      flex: 0 0 auto;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(249,115,22,0.35);
      background: rgba(249,115,22,0.10);
      color: rgba(249,115,22,0.95);
      font-size: 18px;
      line-height: 1;
      box-shadow: 0 10px 20px rgba(0,0,0,0.18);
    }

    /* ===== Footer (EXACT quiet style) ===== */
    .app-footer {
      margin-top: 16px;
      padding-bottom: env(safe-area-inset-bottom);
      text-align: center;
      font-size: 12px;
      color: var(--text-muted);
      opacity: 0.75;
      user-select: none;
    }
  </style>
</head>

<body>
  <div class="safe">
    <div class="wrap">

      <header class="topbar">
        <div class="brand">
          <h1><span class="dot"></span>Scorekeeper Hub</h1>
          <p>Select a scorer to start a game</p>
        </div>
        <button id="reloadBtn" class="btn">⟳ Reload</button>
      </header>

      <main class="content">
        <section class="panel">
          <h2>Available Scorers</h2>
          <div id="list" class="list"></div>
        </section>
      </main>

      <footer class="app-footer">
        Cote Free Time Productions
      </footer>

    </div>
  </div>

  <script>
    (function () {
      const CONFIG_URL = "./scorers.json";
      const listEl = document.getElementById("list");
      const reloadBtn = document.getElementById("reloadBtn");

      reloadBtn.addEventListener("click", () => loadScorers(true));

      function clearList() { listEl.innerHTML = ""; }

      function isValidScorer(s) {
        return s && typeof s.name === "string" && s.name.trim()
               && typeof s.url === "string" && s.url.trim();
      }

      function goTo(url) { window.location.href = url; }

      function initials(name) {
        const parts = name.trim().split(/\s+/).slice(0, 2);
        return parts.map(p => p[0]?.toUpperCase() || "").join("");
      }

      function createThumb(imageUrl, name) {
        const thumb = document.createElement("div");
        thumb.className = "thumb";

        if (imageUrl && typeof imageUrl === "string" && imageUrl.trim()) {
          const img = document.createElement("img");
          img.alt = `${name} icon`;
          img.loading = "lazy";
          img.src = imageUrl.trim();

          img.onerror = () => {
            thumb.innerHTML = "";
            const ph = document.createElement("div");
            ph.className = "placeholder";
            ph.textContent = initials(name);
            thumb.appendChild(ph);
          };

          thumb.appendChild(img);
        } else {
          const ph = document.createElement("div");
          ph.className = "placeholder";
          ph.textContent = initials(name);
          thumb.appendChild(ph);
        }

        return thumb;
      }

      function createCard(scorer) {
        const card = document.createElement("button");
        card.type = "button";
        card.className = "card";
        card.setAttribute("aria-label", `Open ${scorer.name} scorer`);

        const thumb = createThumb(scorer.image, scorer.name);

        const meta = document.createElement("div");
        meta.className = "meta";

        const name = document.createElement("p");
        name.className = "name";
        name.textContent = scorer.name;

        const sub = document.createElement("p");
        sub.className = "subline";
        sub.textContent = scorer.subtitle && String(scorer.subtitle).trim()
          ? String(scorer.subtitle).trim()
          : "Tap to launch";

        const chev = document.createElement("div");
        chev.className = "chev";
        chev.textContent = "›";

        meta.appendChild(name);
        meta.appendChild(sub);

        card.appendChild(thumb);
        card.appendChild(meta);
        card.appendChild(chev);

        card.addEventListener("click", () => goTo(scorer.url.trim()));

        return card;
      }

      async function loadScorers(bustCache = false) {
        clearList();
        const url = bustCache ? `${CONFIG_URL}?v=${Date.now()}` : CONFIG_URL;

        try {
          const res = await fetch(url, { cache: "no-store" });
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const data = await res.json();
          const list = Array.isArray(data.scorers) ? data.scorers : [];

          const valid = list.filter(isValidScorer);
          valid.forEach(s => listEl.appendChild(createCard(s)));

        } catch (e) {
          console.error("Failed to load scorers.json", e);
          const msg = document.createElement("div");
          msg.style.color = "rgba(254,202,202,0.95)";
          msg.style.background = "rgba(239,68,68,0.10)";
          msg.style.border = "1px solid rgba(239,68,68,0.35)";
          msg.style.borderRadius = "16px";
          msg.style.padding = "12px 14px";
          msg.textContent = "Could not load scorers.json (local file mode blocks fetch). Run via a local server or GitHub Pages.";
          listEl.appendChild(msg);
        }
      }

      loadScorers();
    })();
  </script>
</body>
</html>
